{"version":3,"sources":["file:///Users/waostudio/Desktop/Fix4/assets/Scripts/NetworkConnect.ts"],"names":["_decorator","Component","instantiate","Label","Node","Prefab","Sprite","SpriteFrame","tween","Vec3","Animation","Colyseus","AudioController","Chip","ccclass","property","NetworkConnect","type","String","Number","Boolean","client","room","gameState","resultDragon","resultTiger","TotalUser","UserBet","NotmeBet","result","winner","currentHost","balanceUser","TotalBalanceUser","betDragon","betTiger","betTie","totaluserBetDragon","totaluserBetTiger","totaluserBetTie","start","Client","useSSL","hostname","port","connect","rooms","getAvailableRooms","length","create","console","log","sessionId","joinById","roomId","onMessage","message","TimerDown","string","onAudio","PayoutAnim","winAnimPlus","dragonCard","value","tigerCard","playerID","betType","createSpriteNode","balance","setInterval","send","onStateChange","state","roundState","totalBetDragon","totalBetTiger","totalBetTie","totalUserBetDragon","totalUserBetTiger","totalUserBetTie","currentHostId","players","values","updatePlayerList","isHost","onLeave","code","e","error","playerList","displayIndex","numElements","ListL","forEach","node","active","i","ListLabel","spriteNode","prfab","v3","PosTarget","DragonNode","TigerNode","TieNode","addChild","inverseTransformPoint","worldPosition","to","position","call","winnerList","winnerNode","findWinnerNode","PayUser","createSpriteNodePay","x","y","PayUserSprite","winid","price","CoinWinAni","toString","getComponent","play","winnerName","posX","posY","spriteFrames","scale","spriteComponent","addComponent","spriteFrame","delay"],"mappings":"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","sourcesContent":["import {\n  _decorator,\n  Component,\n  instantiate,\n  Label,\n  Node,\n  Prefab,\n  Sprite,\n  SpriteFrame,\n  tween,\n  Vec3,\n  Animation,\n} from \"cc\";\nconst { ccclass, property } = _decorator;\nimport Colyseus from \"db://colyseus-sdk/colyseus.js\";\nimport { AudioController } from \"./AudioController\";\nimport { Chip } from \"./Chip\";\n\n@ccclass(\"NetworkConnect\")\nexport class NetworkConnect extends Component {\n  @property({ type: String })\n  hostname = \"localhost\";\n\n  @property({ type: Number })\n  port = 80;\n\n  @property({ type: Boolean })\n  useSSL = true;\n\n  @property({ type: Node })\n  private ListL: Node[] = [];\n\n  @property({ type: Label })\n  public ListLabel: Label[] = [];\n\n  @property(Label)\n  private TimerDown: Label;\n\n  @property(Label)\n  private CoinWinAni: Label;\n\n  @property({\n    type: Chip,\n  })\n  private chipNode: Chip;\n\n  @property({\n    type: Prefab,\n  })\n  private prfab: Prefab;\n\n  @property({\n    type: Node,\n  })\n  private DragonNode: Node;\n\n  @property({\n    type: Node,\n  })\n  private TigerNode: Node;\n\n  @property({\n    type: Node,\n  })\n  private TieNode: Node;\n\n  @property({\n    type: Node,\n  })\n  private PayUser: Node;\n\n  client!: Colyseus.Client;\n  room!: Colyseus.Room;\n  gameState;\n  resultDragon: number = 0;\n  resultTiger: number = 0;\n  TotalUser;\n  UserBet;\n  NotmeBet;\n  result;\n  winner;\n  currentHost: any;\n  balanceUser: any;\n  TotalBalanceUser: any;\n  betDragon: any;\n  betTiger: any;\n  betTie: any;\n  totaluserBetDragon: any;\n  totaluserBetTiger: any;\n  totaluserBetTie: any;\n\n  @property({\n    type: AudioController,\n  })\n  private AudioController: AudioController;\n\n  @property({\n    type: SpriteFrame,\n  })\n  private PayUserSprite: SpriteFrame[] = [];\n\n  start() {\n    this.client = new Colyseus.Client(\n      `${this.useSSL ? \"wss\" : \"ws\"}://${this.hostname}:${this.port}`\n    );\n\n    this.connect();\n  }\n\n  async connect() {\n    try {\n      const rooms = await this.client.getAvailableRooms(\"room1\");\n\n      if (rooms.length === 0) {\n        this.room = await this.client.create(\"room1\");\n        console.log(\"Created new room with sessionId:\", this.room.sessionId);\n      } else {\n        // Nếu có phòng có sẵn, tham gia vào phòng đầu tiên trong danh sách\n        this.room = await this.client.joinById(rooms[0].roomId);\n        console.log(\n          \"Joined existing room with sessionId:\",\n          this.room.sessionId\n        );\n      }\n\n      console.log(\"Joined successfully!\");\n      console.log(\"User's sessionId:\", this.room.sessionId);\n\n      this.room.onMessage(\"timer\", (message) => {\n        this.TimerDown.string = message;\n        if (message < 30 && message > 0) {\n          this.AudioController.onAudio(3);\n        }\n        if (message === 0) {\n          this.AudioController.onAudio(4);\n        }\n      });\n\n      this.room.onMessage(\"winnerList\", (message) => {\n        console.log(\"WinList\", message);\n        this.PayoutAnim(message);\n        this.winAnimPlus(message);\n      });\n\n      this.room.onMessage(\"result\", (message) => {\n        console.log(message.result);\n        console.log(\"rong\", message.dragonCard.value);\n        console.log(\"ho\", message.tigerCard.value);\n        this.result = message.result;\n      });\n\n      this.room.onMessage(\"userBet\", (message) => {\n        if (message.playerID !== this.room.sessionId) {\n          console.log(\"message\", message);\n          this.UserBet = message.betType;\n          this.createSpriteNode(message.playerID);\n        } else {\n          console.log(\"false\");\n        }\n      });\n\n      this.room.onMessage(\"balance\", (message) => {\n        this.balanceUser = message.balance;\n        console.log(message);\n      });\n      setInterval(() => {\n        this.room.send(\"getBalance\");\n      }, 500);\n\n      this.room.onStateChange((state) => {\n        console.log(\"Room state changed:\", state);\n        console.log(\"onStateChange: \", state);\n        console.log(state.roundState);\n\n        this.betDragon = state.totalBetDragon;\n        this.betTiger = state.totalBetTiger;\n        this.betTie = state.totalBetTie;\n        this.totaluserBetDragon = state.totalUserBetDragon;\n        this.totaluserBetTiger = state.totalUserBetTiger;\n        this.totaluserBetTie = state.totalUserBetTie;\n\n        // console.log(this.room.state);\n        this.currentHost = state.currentHostId;\n        console.log(this.currentHost);\n\n        const players = [...state.players.values()];\n\n        this.updatePlayerList(players);\n        console.log(\"PlayerStatus\", players[0].isHost);\n        this.TotalUser = players.length;\n        this.gameState = state.roundState;\n      });\n\n      this.room.onLeave((code) => {\n        console.log(\"Left room with code:\", code);\n      });\n    } catch (e) {\n      console.error(\"Error:\", e);\n    }\n  }\n\n  updatePlayerList(playerList: any[]) {\n    let displayIndex = 0;\n    const numElements = playerList.length;\n    this.ListL.forEach((node) => {\n      node.active = false;\n    });\n    for (let i = 0; i < numElements && displayIndex < this.ListL.length; i++) {\n      if (\n        playerList[i].sessionId !== this.room.sessionId &&\n        playerList[i].sessionId !== this.currentHost\n      ) {\n        this.ListLabel[displayIndex].string = playerList[i].sessionId;\n        this.ListL[displayIndex].active = true;\n        displayIndex++;\n        this.AudioController.onAudio(9);\n      }\n    }\n    for (let i = displayIndex; i < this.ListL.length; i++) {\n      this.ListL[i].active = false;\n    }\n  }\n\n  private createSpriteNode(sessionId: string) {\n    const spriteNode = instantiate(this.prfab);\n    let v3 = new Vec3();\n    let PosTarget;\n    // Kiểm tra nếu sessionId trùng khớp với label nào đó\n    for (let i = 0; i < this.ListLabel.length; i++) {\n      if (sessionId === this.ListLabel[i].string) {\n        // Thêm node mới làm con của node có label tương ứng\n        if (this.UserBet === \"Dragon\") {\n          PosTarget = this.DragonNode;\n        } else if (this.UserBet === \"Tiger\") {\n          PosTarget = this.TigerNode;\n        } else {\n          PosTarget = this.TieNode;\n        }\n        this.ListLabel[i].node.addChild(spriteNode);\n        this.ListLabel[i].node.inverseTransformPoint(\n          v3,\n          PosTarget.worldPosition\n        );\n        tween(spriteNode)\n          .to(0.3, { position: v3 })\n          .call(() => {})\n          .start();\n\n        break; // Dừng vòng lặp sau khi thêm node\n      }\n    }\n  }\n\n  private PayoutAnim(winnerList) {\n    if (winnerList.length > 0) {\n      this.AudioController.onAudio(6);\n    }\n\n    // Lặp qua danh sách người chiến thắng và tạo nút trả tiền cho mỗi người chiến thắng\n    for (let i = 0; i < winnerList.length; i++) {\n      const winner = winnerList[i].sessionId;\n\n      // Tìm node tương ứng với người chiến thắng\n      const winnerNode = this.findWinnerNode(winner);\n\n      if (winnerNode) {\n        console.log(\"ddax chay\");\n\n        let v3 = new Vec3();\n        this.PayUser.inverseTransformPoint(v3, winnerNode.worldPosition);\n        // Tạo nút trả tiền cho người chiến thắng\n        this.createSpriteNodePay(v3.x, v3.y, this.PayUserSprite);\n      }\n    }\n  }\n  private winAnimPlus(winid) {\n    for (let i = 0; i < winid.length; i++) {\n      if (winid[i].sessionId === this.room.sessionId) {\n        console.log(\"Price:\", winid[i].price);\n\n        this.CoinWinAni.string = \"+\" + winid[i].price.toString();\n        this.CoinWinAni.node.active = true;\n        this.CoinWinAni.node.getComponent(Animation).play();\n        break; // Nếu tìm thấy phần tử thỏa mãn, dừng vòng lặp\n      }\n    }\n  }\n\n  // Hàm để tìm node tương ứng với người chiến thắng\n  private findWinnerNode(winnerName) {\n    // Lặp qua danh sách nhãn để tìm node có tên trùng khớp với người chiến thắng\n    for (let i = 0; i < this.ListLabel.length; i++) {\n      if (winnerName === this.ListLabel[i].string) {\n        return this.ListLabel[i].node;\n      }\n    }\n    return null; // Trả về null nếu không tìm thấy node\n  }\n\n  createSpriteNodePay(posX, posY, spriteFrames: SpriteFrame[]) {\n    // Lặp qua từng sprite frame để tạo node tương ứng\n    for (let i = 0; i < spriteFrames.length; i++) {\n      // Tạo một Node mới\n      const spriteNode = new Node(\"SpriteNode\");\n      spriteNode.scale = new Vec3(0.5, 0.5);\n\n      // Thêm một component Sprite vào Node\n      const spriteComponent = spriteNode.addComponent(Sprite);\n\n      // Gán SpriteFrame cho component Sprite dựa trên index\n      spriteComponent.spriteFrame = spriteFrames[i];\n\n      // Thêm Node vào Scene hiện tại (ví dụ: Node cha của tất cả Sprite)\n      this.PayUser.addChild(spriteNode); // Giả sử winner.node là node của người chiến thắng\n\n      // Tween Node đến vị trí mong muốn\n      tween(spriteNode)\n        .delay(i * 0.1) // thiết lập thời gian trễ dựa trên index của node\n        .to(1, { position: new Vec3(posX, posY) })\n        .call(() => {\n          spriteNode.active = false;\n        })\n        .start();\n    }\n  }\n}\n"]}